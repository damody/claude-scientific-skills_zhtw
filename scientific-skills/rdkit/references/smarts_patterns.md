# RDKit 常用 SMARTS 模式

本文件提供用於 RDKit 子結構搜尋的常用 SMARTS 模式集合。

## 官能基

### 醇

```python
# 一級醇
'[CH2][OH1]'

# 二級醇
'[CH1]([OH1])[CH3,CH2]'

# 三級醇
'[C]([OH1])([C])([C])[C]'

# 任意醇
'[OH1][C]'

# 酚
'c[OH1]'
```

### 醛和酮

```python
# 醛
'[CH1](=O)'

# 酮
'[C](=O)[C]'

# 任意羰基
'[C](=O)'
```

### 羧酸及衍生物

```python
# 羧酸
'C(=O)[OH1]'
'[CX3](=O)[OX2H1]'  # 更具體

# 酯
'C(=O)O[C]'
'[CX3](=O)[OX2][C]'  # 更具體

# 醯胺
'C(=O)N'
'[CX3](=O)[NX3]'  # 更具體

# 醯氯
'C(=O)Cl'

# 酸酐
'C(=O)OC(=O)'
```

### 胺

```python
# 一級胺
'[NH2][C]'

# 二級胺
'[NH1]([C])[C]'

# 三級胺
'[N]([C])([C])[C]'

# 芳香胺（苯胺）
'c[NH2]'

# 任意胺
'[NX3]'
```

### 醚

```python
# 脂肪族醚
'[C][O][C]'

# 芳香醚
'c[O][C,c]'
```

### 鹵化物

```python
# 烷基鹵化物
'[C][F,Cl,Br,I]'

# 芳基鹵化物
'c[F,Cl,Br,I]'

# 特定鹵化物
'[C]F'  # 氟化物
'[C]Cl'  # 氯化物
'[C]Br'  # 溴化物
'[C]I'  # 碘化物
```

### 腈和硝基

```python
# 腈
'C#N'

# 硝基
'[N+](=O)[O-]'

# 芳香硝基
'c[N+](=O)[O-]'
```

### 硫醇和硫化物

```python
# 硫醇
'[C][SH1]'

# 硫化物
'[C][S][C]'

# 二硫化物
'[C][S][S][C]'

# 亞碸
'[C][S](=O)[C]'

# 碸
'[C][S](=O)(=O)[C]'
```

## 環系統

### 簡單環

```python
# 苯環
'c1ccccc1'
'[#6]1:[#6]:[#6]:[#6]:[#6]:[#6]:1'  # 明確原子

# 環己烷
'C1CCCCC1'

# 環戊烷
'C1CCCC1'

# 任意 3 元環
'[r3]'

# 任意 4 元環
'[r4]'

# 任意 5 元環
'[r5]'

# 任意 6 元環
'[r6]'

# 任意 7 元環
'[r7]'
```

### 芳香環

```python
# 環中的芳香碳
'[cR]'

# 環中的芳香氮（吡啶等）
'[nR]'

# 環中的芳香氧（呋喃等）
'[oR]'

# 環中的芳香硫（噻吩等）
'[sR]'

# 任意芳香環
'a1aaaaa1'
```

### 雜環

```python
# 吡啶
'n1ccccc1'

# 吡咯
'n1cccc1'

# 呋喃
'o1cccc1'

# 噻吩
's1cccc1'

# 咪唑
'n1cncc1'

# 嘧啶
'n1cnccc1'

# 噻唑
'n1ccsc1'

# 噁唑
'n1ccoc1'
```

### 稠環

```python
# 萘
'c1ccc2ccccc2c1'

# 吲哚
'c1ccc2[nH]ccc2c1'

# 喹啉
'n1cccc2ccccc12'

# 苯並咪唑
'c1ccc2[nH]cnc2c1'

# 嘌呤
'n1cnc2ncnc2c1'
```

### 大環

```python
# 8 個或更多原子的環
'[r{8-}]'

# 9-15 個原子的環
'[r{9-15}]'

# 超過 12 個原子的環（大環）
'[r{12-}]'
```

## 特定結構特徵

### 脂肪族 vs 芳香族

```python
# 脂肪族碳
'[C]'

# 芳香碳
'[c]'

# 環中的脂肪族碳
'[CR]'

# 芳香碳（替代）
'[cR]'
```

### 立體化學

```python
# 順時針手性的四面體中心
'[C@]'

# 逆時針手性的四面體中心
'[C@@]'

# 任意手性中心
'[C@,C@@]'

# E 雙鍵
'C/C=C/C'

# Z 雙鍵
'C/C=C\\C'
```

### 雜化

```python
# SP 雜化（參鍵）
'[CX2]'

# SP2 雜化（雙鍵或芳香）
'[CX3]'

# SP3 雜化（單鍵）
'[CX4]'
```

### 電荷

```python
# 正電荷
'[+]'

# 負電荷
'[-]'

# 特定電荷
'[+1]'
'[-1]'
'[+2]'

# 帶正電的氮
'[N+]'

# 帶負電的氧
'[O-]'

# 羧酸陰離子
'C(=O)[O-]'

# 銨陽離子
'[N+]([C])([C])([C])[C]'
```

## 藥效團特徵

### 氫鍵供體

```python
# 羥基
'[OH]'

# 胺
'[NH,NH2]'

# 醯胺 NH
'[N][C](=O)'

# 任意氫鍵供體
'[OH,NH,NH2,NH3+]'
```

### 氫鍵受體

```python
# 羰基氧
'[O]=[C,S,P]'

# 醚氧
'[OX2]'

# 酯氧
'C(=O)[O]'

# 氮受體
'[N;!H0]'

# 任意氫鍵受體
'[O,N]'
```

### 疏水基團

```python
# 烷基鏈（4+ 個碳）
'CCCC'

# 分支烷基
'C(C)(C)C'

# 芳香環（疏水）
'c1ccccc1'
```

### 芳香相互作用

```python
# 用於 pi-pi 堆疊的苯
'c1ccccc1'

# 用於 pi-pi 的雜環
'[a]1[a][a][a][a][a]1'

# 任意芳香環
'[aR]'
```

## 類藥片段

### Lipinski 片段

```python
# 帶取代基的芳香環
'c1cc(*)ccc1'

# 脂肪族鏈
'CCCC'

# 醚連接
'[C][O][C]'

# 胺（鹼性中心）
'[N]([C])([C])'
```

### 常見骨架

```python
# 苯甲醯胺
'c1ccccc1C(=O)N'

# 磺醯胺
'S(=O)(=O)N'

# 脲
'[N][C](=O)[N]'

# 胍
'[N]C(=[N])[N]'

# 磷酸根
'P(=O)([O-])([O-])[O-]'
```

### 優勢結構

```python
# 聯苯
'c1ccccc1-c2ccccc2'

# 苯並吡喃
'c1ccc2OCCCc2c1'

# 哌嗪
'N1CCNCC1'

# 哌啶
'N1CCCCC1'

# 嗎啡啉
'N1CCOCC1'
```

## 反應性基團

### 親電子體

```python
# 醯氯
'C(=O)Cl'

# 烷基鹵化物
'[C][Cl,Br,I]'

# 環氧化物
'C1OC1'

# Michael 受體
'C=C[C](=O)'
```

### 親核體

```python
# 一級胺
'[NH2][C]'

# 硫醇
'[SH][C]'

# 醇
'[OH][C]'
```

## 毒性警報（PAINS）

```python
# 羅丹寧
'S1C(=O)NC(=S)C1'

# 鄰苯二酚
'c1ccc(O)c(O)c1'

# 醌
'O=C1C=CC(=O)C=C1'

# 氫醌
'OC1=CC=C(O)C=C1'

# 烷基鹵化物（反應性）
'[C][I,Br]'

# Michael 受體（反應性）
'C=CC(=O)[C,N]'
```

## 金屬結合

```python
# 羧酸根（金屬螯合劑）
'C(=O)[O-]'

# 異羥肟酸
'C(=O)N[OH]'

# 鄰苯二酚（鐵螯合劑）
'c1c(O)c(O)ccc1'

# 硫醇（金屬結合）
'[SH]'

# 組氨酸類（金屬結合）
'c1ncnc1'
```

## 大小和複雜度過濾

```python
# 長脂肪鏈（>6 個碳）
'CCCCCCC'

# 高度分支（季碳）
'C(C)(C)(C)C'

# 多個環
'[R]~[R]'  # 兩個連接的環

# 螺中心
'[C]12[C][C][C]1[C][C]2'
```

## 特殊模式

### 原子計數

```python
# 任意原子
'[*]'

# 重原子（非 H）
'[!H]'

# 碳
'[C,c]'

# 雜原子
'[!C;!H]'

# 鹵素
'[F,Cl,Br,I]'
```

### 鍵類型

```python
# 單鍵
'C-C'

# 雙鍵
'C=C'

# 參鍵
'C#C'

# 芳香鍵
'c:c'

# 任意鍵
'C~C'
```

### 環成員

```python
# 在任意環中
'[R]'

# 不在環中
'[!R]'

# 恰好在一個環中
'[R1]'

# 恰好在兩個環中
'[R2]'

# 環鍵
'[R]~[R]'
```

### 度和連接性

```python
# 總度為 1（末端原子）
'[D1]'

# 總度為 2（鏈）
'[D2]'

# 總度為 3（分支點）
'[D3]'

# 總度為 4（高度分支）
'[D4]'

# 恰好連接 2 個碳
'[C]([C])[C]'
```

## 使用範例

```python
from rdkit import Chem

# 建立 SMARTS 查詢
pattern = Chem.MolFromSmarts('[CH2][OH1]')  # 一級醇

# 搜尋分子
mol = Chem.MolFromSmiles('CCO')
matches = mol.GetSubstructMatches(pattern)

# 多個模式
patterns = {
    'alcohol': '[OH1][C]',
    'amine': '[NH2,NH1][C]',
    'carboxylic_acid': 'C(=O)[OH1]'
}

# 檢查官能基
for name, smarts in patterns.items():
    query = Chem.MolFromSmarts(smarts)
    if mol.HasSubstructMatch(query):
        print(f"找到 {name}")
```

## 編寫 SMARTS 的提示

1. **需要時要具體：** 使用原子性質 [CX3] 而非只用 [C]
2. **使用方括號增加清晰度：** [C] 與 C（芳香）不同
3. **考慮芳香性：** 小寫字母（c、n、o）是芳香的
4. **檢查環成員：** [R] 表示在環中，[!R] 表示不在環中
5. **使用遞迴 SMARTS：** $(...) 用於複雜模式
6. **測試模式：** 始終在已知分子上驗證 SMARTS
7. **從簡單開始：** 逐步建構複雜模式

## 常見 SMARTS 語法

- `[C]` - 脂肪族碳
- `[c]` - 芳香碳
- `[CX4]` - 4 個連接的碳（sp3）
- `[CX3]` - 3 個連接的碳（sp2）
- `[CX2]` - 2 個連接的碳（sp）
- `[CH3]` - 甲基
- `[R]` - 在環中
- `[r6]` - 在 6 元環中
- `[r{5-7}]` - 在 5、6 或 7 元環中
- `[D2]` - 度為 2（2 個鄰居）
- `[+]` - 正電荷
- `[-]` - 負電荷
- `[!C]` - 非碳
- `[#6]` - 原子序數為 6 的元素（碳）
- `~` - 任意鍵類型
- `-` - 單鍵
- `=` - 雙鍵
- `#` - 參鍵
- `:` - 芳香鍵
- `@` - 順時針手性
- `@@` - 逆時針手性
