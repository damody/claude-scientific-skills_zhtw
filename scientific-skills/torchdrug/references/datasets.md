# 資料集參考

## 概述

TorchDrug 提供 40 多個跨多個領域的精選資料集：分子性質預測、蛋白質建模、知識圖譜推理和逆合成。所有資料集支援延遲載入、自動下載和可自訂的特徵提取。

## 分子性質預測資料集

### 藥物發現分類

| 資料集 | 大小 | 任務 | 類別 | 描述 |
|---------|------|------|---------|-------------|
| **BACE** | 1,513 | 二元 | 2 | 阿茲海默症的 β-分泌酶抑制 |
| **BBBP** | 2,039 | 二元 | 2 | 血腦屏障穿透 |
| **HIV** | 41,127 | 二元 | 2 | HIV 複製抑制 |
| **ClinTox** | 1,478 | 多標籤 | 2 | 臨床試驗毒性 |
| **SIDER** | 1,427 | 多標籤 | 27 | 按系統器官分類的副作用 |
| **Tox21** | 7,831 | 多標籤 | 12 | 12 個標靶的毒性 |
| **ToxCast** | 8,576 | 多標籤 | 617 | 高通量毒理學 |
| **MUV** | 93,087 | 多標籤 | 17 | 篩選的無偏驗證 |

**關鍵特徵：**
- 全部使用骨架分割進行現實評估
- 二元分類指標：AUROC、AUPRC
- 多標籤處理缺失值

**使用案例：**
- 藥物安全預測
- 虛擬篩選
- ADMET 性質預測

### 藥物發現迴歸

| 資料集 | 大小 | 性質 | 單位 | 描述 |
|---------|------|----------|-------|-------------|
| **ESOL** | 1,128 | 溶解度 | log(mol/L) | 水溶性 |
| **FreeSolv** | 642 | 水合 | kcal/mol | 水合自由能 |
| **Lipophilicity** | 4,200 | LogD | - | 辛醇/水分配係數 |
| **SAMPL** | 643 | 溶劑化 | kcal/mol | 溶劑化自由能 |

**指標：**MAE、RMSE、R²
**使用案例：**ADME 最佳化、先導化合物最佳化

### 量子化學

| 資料集 | 大小 | 性質 | 描述 |
|---------|------|------------|-------------|
| **QM7** | 7,165 | 1 | 原子化能 |
| **QM8** | 21,786 | 12 | 電子光譜、激發態 |
| **QM9** | 133,885 | 12 | 幾何、能量、電子、熱力學 |
| **PCQM4M** | 3.8M | 1 | 大規模 HOMO-LUMO 能隙 |

**性質（QM9）：**
- 偶極矩
- 各向同性極化率
- HOMO/LUMO 能量
- 內能、焓、自由能
- 熱容
- 電子空間範圍

**使用案例：**
- 量子性質預測
- 方法開發基準測試
- 分子模型預訓練

### 大型分子資料庫

| 資料集 | 大小 | 描述 | 使用案例 |
|---------|------|-------------|----------|
| **ZINC250k** | 250,000 | 類藥分子 | 生成模型訓練 |
| **ZINC2M** | 2,000,000 | 類藥分子 | 大規模預訓練 |
| **ChEMBL** | 百萬級 | 生物活性分子 | 性質預測、生成 |

## 蛋白質資料集

### 功能預測

| 資料集 | 大小 | 任務 | 類別 | 描述 |
|---------|------|------|---------|-------------|
| **EnzymeCommission** | 17,562 | 多類 | 7 級 | EC 編號分類 |
| **GeneOntology** | 46,796 | 多標籤 | 489 | GO 術語預測（BP/MF/CC）|
| **BetaLactamase** | 5,864 | 迴歸 | - | 酵素活性水平 |
| **Fluorescence** | 54,025 | 迴歸 | - | GFP 螢光強度 |
| **Stability** | 53,614 | 迴歸 | - | 熱穩定性（ΔΔG）|

**特徵：**
- 序列和/或結構輸入
- 演化資訊可用
- 多個訓練/測試分割

**使用案例：**
- 蛋白質工程
- 功能註釋
- 酵素設計

### 定位和溶解度

| 資料集 | 大小 | 任務 | 類別 | 描述 |
|---------|------|------|---------|-------------|
| **Solubility** | 62,478 | 二元 | 2 | 蛋白質溶解度 |
| **BinaryLocalization** | 22,168 | 二元 | 2 | 膜蛋白 vs 可溶性 |
| **SubcellularLocalization** | 8,943 | 多類 | 10 | 亞細胞區室 |

**使用案例：**
- 蛋白質表達最佳化
- 標靶識別
- 細胞生物學

### 結構預測

| 資料集 | 大小 | 任務 | 描述 |
|---------|------|------|-------------|
| **Fold** | 16,712 | 多類（1,195）| 結構摺疊識別 |
| **SecondaryStructure** | 8,678 | 序列標註 | 3 態或 8 態預測 |
| **ProteinNet** | 可變 | 接觸預測 | 殘基-殘基接觸 |

**使用案例：**
- 結構預測管線
- 摺疊識別
- 接觸圖生成

### 蛋白質交互作用

| 資料集 | 大小 | 正樣本 | 負樣本 | 描述 |
|---------|------|-----------|-----------|-------------|
| **HumanPPI** | 1,412 個蛋白質 | 6,584 | - | 人類蛋白質交互作用網路 |
| **YeastPPI** | 2,018 個蛋白質 | 6,451 | - | 酵母蛋白質交互作用網路 |
| **PPIAffinity** | 2,156 對 | - | - | 結合親和力值 |

**使用案例：**
- PPI 預測
- 網路生物學
- 藥物標靶識別

### 蛋白質-配體結合

| 資料集 | 大小 | 類型 | 描述 |
|---------|------|------|-------------|
| **BindingDB** | ~150 萬 | 親和力 | 綜合結合資料 |
| **PDBBind** | 20,000+ | 3D 複合物 | 基於結構的結合 |
| - 精製集 | 5,316 | 高品質 | 精選晶體結構 |
| - 核心集 | 285 | 基準 | 多樣測試集 |

**使用案例：**
- 結合親和力預測
- 基於結構的藥物設計
- 評分函數開發

### 大型蛋白質資料庫

| 資料集 | 大小 | 描述 |
|---------|------|-------------|
| **AlphaFoldDB** | 2 億+ | 大多數已知蛋白質的預測結構 |
| **UniProt** | 整合 | 序列和註釋資料 |

## 知識圖譜資料集

### 通用知識

| 資料集 | 實體 | 關係 | 三元組 | 領域 |
|---------|----------|-----------|---------|--------|
| **FB15k** | 14,951 | 1,345 | 592,213 | Freebase（通用知識）|
| **FB15k-237** | 14,541 | 237 | 310,116 | 過濾的 Freebase |
| **WN18** | 40,943 | 18 | 151,442 | WordNet（詞彙）|
| **WN18RR** | 40,943 | 11 | 93,003 | 過濾的 WordNet |

**關係類型（FB15k-237）：**
- `/people/person/nationality`
- `/film/film/genre`
- `/location/location/contains`
- `/business/company/founders`
- 更多...

**使用案例：**
- 連結預測
- 關係提取
- 知識庫補全

### 生物醫學知識

| 資料集 | 實體 | 關係 | 三元組 | 描述 |
|---------|----------|-----------|---------|-------------|
| **Hetionet** | 45,158 | 24 | 2,250,197 | 整合 29 個生物醫學資料庫 |

**Hetionet 中的實體類型：**
- 基因（20,945）
- 化合物（1,552）
- 疾病（137）
- 解剖結構（400）
- 路徑（1,822）
- 藥理學類別
- 副作用
- 症狀
- 分子功能
- 生物過程
- 細胞組件

**關係類型：**
- 化合物-結合-基因
- 基因-關聯-疾病
- 疾病-呈現-症狀
- 化合物-治療-疾病
- 化合物-導致-副作用
- 基因-參與-路徑
- 還有 18 種更多...

**使用案例：**
- 藥物再利用
- 疾病機制發現
- 標靶識別
- 生物醫學多跳推理

## 引用網路資料集

| 資料集 | 節點 | 邊 | 類別 | 描述 |
|---------|-------|-------|---------|-------------|
| **Cora** | 2,708 | 5,429 | 7 | 機器學習論文 |
| **CiteSeer** | 3,327 | 4,732 | 6 | 計算機科學論文 |
| **PubMed** | 19,717 | 44,338 | 3 | 生物醫學論文 |

**使用案例：**
- 節點分類
- GNN 基線比較
- 方法開發

## 逆合成資料集

| 資料集 | 大小 | 描述 |
|---------|------|-------------|
| **USPTO-50k** | 50,017 | 精選專利反應，單步驟 |

**特徵：**
- 產物 → 反應物映射
- 反應中心的原子映射
- 規範化 SMILES
- 跨反應類型平衡

**分割：**
- 訓練：~40,000
- 驗證：~5,000
- 測試：~5,000

**使用案例：**
- 逆合成預測
- 反應類型分類
- 合成路線規劃

## 資料集使用模式

### 載入資料集

```python
from torchdrug import datasets

# 基本載入
dataset = datasets.BBBP("~/molecule-datasets/")

# 含轉換
from torchdrug import transforms
transform = transforms.VirtualNode()
dataset = datasets.BBBP("~/molecule-datasets/", transform=transform)

# 蛋白質資料集
dataset = datasets.EnzymeCommission("~/protein-datasets/")

# 知識圖譜
dataset = datasets.FB15k237("~/kg-datasets/")
```

### 資料分割

```python
# 隨機分割
train, valid, test = dataset.split([0.8, 0.1, 0.1])

# 骨架分割（用於分子）
from torchdrug import utils
train, valid, test = dataset.split(
    utils.scaffold_split(dataset, [0.8, 0.1, 0.1])
)

# 預定義分割（某些資料集）
train, valid, test = dataset.split()
```

### 特徵提取

**節點特徵（分子）：**
- 原子類型（獨熱或嵌入）
- 形式電荷
- 雜化
- 芳香性
- 氫數量
- 手性

**邊特徵（分子）：**
- 鍵類型（單鍵、雙鍵、三鍵、芳香）
- 立體化學
- 共軛
- 環成員資格

**節點特徵（蛋白質）：**
- 胺基酸類型（獨熱）
- 物理化學性質
- 序列中的位置
- 二級結構
- 溶劑可及性

**邊特徵（蛋白質）：**
- 邊類型（序列、空間、接觸）
- 距離
- 角度和二面角

## 選擇資料集

### 按任務

**分子性質預測：**
- 從 BBBP 或 HIV 開始（中等大小、清晰任務）
- 量子性質使用 QM9
- 迴歸使用 ESOL/FreeSolv

**蛋白質功能：**
- EnzymeCommission（定義明確的類別）
- GeneOntology（綜合註釋）

**藥物安全：**
- Tox21（標準基準）
- ClinTox（臨床相關性）

**基於結構：**
- PDBBind（蛋白質-配體）
- ProteinNet（結構預測）

**知識圖譜：**
- FB15k-237（標準基準）
- Hetionet（生物醫學應用）

**生成：**
- ZINC250k（訓練）
- QM9（含性質）

**逆合成：**
- USPTO-50k（唯一選擇）

### 按大小和資源

**小型（<5k，用於測試）：**
- BACE、FreeSolv、ClinTox
- PDBBind 核心集

**中型（5k-100k）：**
- BBBP、HIV、ESOL、Tox21
- EnzymeCommission、Fold
- FB15k-237、WN18RR

**大型（>100k）：**
- QM9、MUV、PCQM4M
- GeneOntology、AlphaFoldDB
- ZINC2M、BindingDB

### 按領域

**藥物發現：**BBBP、HIV、Tox21、ESOL、ZINC
**量子化學：**QM7、QM8、QM9、PCQM4M
**蛋白質工程：**Fluorescence、Stability、Solubility
**結構生物學：**Fold、PDBBind、ProteinNet、AlphaFoldDB
**生物醫學：**Hetionet、GeneOntology、EnzymeCommission
**逆合成：**USPTO-50k

## 最佳實踐

1. **從小開始**：在擴展前先在小型資料集上測試
2. **骨架分割**：用於現實的藥物發現評估
3. **平衡指標**：對不平衡資料使用 AUROC + AUPRC
4. **多次運行**：報告多個隨機種子的平均值 ± 標準差
5. **資料洩漏**：小心預訓練模型
6. **領域知識**：理解您正在預測的內容
7. **驗證**：始終使用保留測試集
8. **預處理**：標準化特徵、處理缺失值
